
[default]

exten => test_variable,1,NoOp()
same => n,Set(endpoint=${LOCAL(ARG1)})
same => n,Set(field=${LOCAL(ARG2)})
same => n,Set(expected=${LOCAL(ARG3)})
same => n,Verbose(1, Calling PJSIP_ENDPOINT for endpoint ${endpoint}, field ${field})
same => n,GotoIf($["${PJSIP_ENDPOINT(${endpoint},${field})}"="${expected}"]?pass)
same => n,UserEvent(Result, Status: failed, Message: ${endpoint}, ${field} did not match expected value ${expected} - actual ${PJSIP_ENDPOINT(${endpoint},${field})})
same => n(pass),NoOp()
same => n,Return()

exten => s,1,NoOp()
same => n,Answer()

; Test Alice's properties
same => n,GoSub(default,test_variable,1(alice,srtp_tag_32,false))
same => n,GoSub(default,test_variable,1(alice,dtls_setup,active))
same => n,GoSub(default,test_variable,1(alice,dtls_ca_path,))
same => n,GoSub(default,test_variable,1(alice,dtls_ca_file,))
same => n,GoSub(default,test_variable,1(alice,dtls_cipher,))
same => n,GoSub(default,test_variable,1(alice,dtls_private_key,))
same => n,GoSub(default,test_variable,1(alice,dtls_cert_file,))
same => n,GoSub(default,test_variable,1(alice,dtls_rekey,0))
same => n,GoSub(default,test_variable,1(alice,dtls_verify,No))
same => n,GoSub(default,test_variable,1(alice,rtp_engine,asterisk))
same => n,GoSub(default,test_variable,1(alice,mwi_from_user,))
same => n,GoSub(default,test_variable,1(alice,from_domain,))
same => n,GoSub(default,test_variable,1(alice,from_user,Alice))
same => n,GoSub(default,test_variable,1(alice,sub_min_expiry,0))
same => n,GoSub(default,test_variable,1(alice,allow_subscribe,true))
same => n,GoSub(default,test_variable,1(alice,cos_video,0))
same => n,GoSub(default,test_variable,1(alice,cos_audio,0))
same => n,GoSub(default,test_variable,1(alice,tos_video,0))
same => n,GoSub(default,test_variable,1(alice,tos_audio,0))
same => n,GoSub(default,test_variable,1(alice,sdp_session,Asterisk))
same => n,GoSub(default,test_variable,1(alice,sdp_owner,-))
same => n,GoSub(default,test_variable,1(alice,allow_transfer,true))
same => n,GoSub(default,test_variable,1(alice,record_off_feature,automixmon))
same => n,GoSub(default,test_variable,1(alice,record_on_feature,automixmon))
same => n,GoSub(default,test_variable,1(alice,language,))
same => n,GoSub(default,test_variable,1(alice,tone_zone,))
same => n,GoSub(default,test_variable,1(alice,t38_udptl_ipv6,false))
same => n,GoSub(default,test_variable,1(alice,t38_udptl_nat,false))
same => n,GoSub(default,test_variable,1(alice,fax_detect,false))
same => n,GoSub(default,test_variable,1(alice,t38_udptl_maxdatagram,0))
same => n,GoSub(default,test_variable,1(alice,t38_udptl_ec,none))
same => n,GoSub(default,test_variable,1(alice,t38_udptl,false))
same => n,GoSub(default,test_variable,1(alice,device_state_busy_at,0))
same => n,GoSub(default,test_variable,1(alice,named_pickup_group,))
same => n,GoSub(default,test_variable,1(alice,named_call_group,))
same => n,GoSub(default,test_variable,1(alice,pickup_group,))
same => n,GoSub(default,test_variable,1(alice,call_group,))
same => n,GoSub(default,test_variable,1(alice,inband_progress,false))
same => n,GoSub(default,test_variable,1(alice,one_touch_recording,false))
same => n,GoSub(default,test_variable,1(alice,use_avpf,false))
same => n,GoSub(default,test_variable,1(alice,media_encryption,none))
same => n,GoSub(default,test_variable,1(alice,aggregate_mwi,true))
same => n,GoSub(default,test_variable,1(alice,mailboxes,))
same => n,GoSub(default,test_variable,1(alice,send_diversion,true))
same => n,GoSub(default,test_variable,1(alice,send_rpid,false))
same => n,GoSub(default,test_variable,1(alice,send_pai,false))
same => n,GoSub(default,test_variable,1(alice,trust_id_outbound,false))
same => n,GoSub(default,test_variable,1(alice,trust_id_inbound,false))
same => n,GoSub(default,test_variable,1(alice,callerid_tag,))
same => n,GoSub(default,test_variable,1(alice,callerid_privacy,allowed))
same => n,GoSub(default,test_variable,1(alice,callerid,<unknown>))
same => n,GoSub(default,test_variable,1(alice,disable_direct_media_on_nat,false))
same => n,GoSub(default,test_variable,1(alice,disable_direct_media_glare_mitigation,))
same => n,GoSub(default,test_variable,1(alice,connected_line_method,invite))
same => n,GoSub(default,test_variable,1(alice,direct_media_method,invite))
same => n,GoSub(default,test_variable,1(alice,direct_media,true))
same => n,GoSub(default,test_variable,1(alice,identify_by,username))
same => n,GoSub(default,test_variable,1(alice,media_address,))
same => n,GoSub(default,test_variable,1(alice,aors,alice))
same => n,GoSub(default,test_variable,1(alice,outbound_auth,))
same => n,GoSub(default,test_variable,1(alice,auth,))
same => n,GoSub(default,test_variable,1(alice,timers_sess_expires,1800))
same => n,GoSub(default,test_variable,1(alice,timers_min_se,90))
same => n,GoSub(default,test_variable,1(alice,timers,yes))
same => n,GoSub(default,test_variable,1(alice,100rel,yes))
same => n,GoSub(default,test_variable,1(alice,moh_suggest,default))
same => n,GoSub(default,test_variable,1(alice,outbound_proxy,))
same => n,GoSub(default,test_variable,1(alice,transport,))
same => n,GoSub(default,test_variable,1(alice,rewrite_contact,false))
same => n,GoSub(default,test_variable,1(alice,force_rport,true))
same => n,GoSub(default,test_variable,1(alice,use_ptime,false))
same => n,GoSub(default,test_variable,1(alice,ice_support,false))
same => n,GoSub(default,test_variable,1(alice,rtp_symmetric,false))
same => n,GoSub(default,test_variable,1(alice,rtp_ipv6,false))
same => n,GoSub(default,test_variable,1(alice,dtmf_mode,rfc4733))
same => n,GoSub(default,test_variable,1(alice,allow,(ulaw|alaw)))
same => n,GoSub(default,test_variable,1(alice,context,default))

; Check that Bob gives us a different value for something it defined
same => n,GoSub(default,test_variable,1(bob,from_user,Bob))

; Check unknown endpoint/field
same => n,GoSub(default,test_variable,1,(foo,from_user,))
same => n,GoSub(default,test_variable,1,(bob,foo,))

same => n,UserEvent(Result, Status: passed)
same => n,Hangup()
