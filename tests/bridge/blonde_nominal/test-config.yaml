testinfo:
    summary: 'Test blonde transfers'
    description: |
        'Set up a bridge between two endpoints and check that the DTMF attended
        transfer feature is detected and executed properly, even when a blonde
        is performing the test (whoops, did I hang up?). Two transfers
        are performed; one initiated by Alice, and the other by Bob. In both
        cases, both are blondes, and hang up before the destination Charlie can
        answer. The test verifies that the respective parties get bridged
        anyway.'

test-modules:
    add-test-to-search-path: 'True'
    test-object:
        config-section: bridge-config
        typename: 'BridgeTestCase.BridgeTestCase'
    modules:
        -
            config-section: 'transfer-config'
            typename: 'transfer.Transfer'

transfer-config:
    -
        transferer: 'alice'
    -
        transferer: 'bob'

bridge-config:
    asterisk-instances: 4
    test-runs:
      -
          originate_channel: 'SIP/alice_atxfer@uut'
          features:
              -
                  who: 'alice'
                  what: 'atxfer'
                  success: 'true'
                  exten: '123'
      -
          originate_channel: 'SIP/bob_atxfer@uut'
          features:
              -
                  who: 'bob'
                  what: 'atxfer'
                  success: 'true'
                  exten: '123'

properties:
    minversion: '11.0.0'
    dependencies:
        - buildoption: 'TEST_FRAMEWORK'
        - python : 'twisted'
        - python : 'starpy'
    tags:
        - bridge
